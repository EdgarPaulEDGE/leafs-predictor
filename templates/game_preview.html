{% extends "base.html" %}

{% block content %}
<div class="preview-hero">
    <div class="preview-matchup">
        <div class="preview-team">
            <img src="https://assets.nhle.com/logos/nhl/svg/{{ away.abbrev }}_dark.svg" class="preview-logo">
            <span class="preview-name">{{ away.placeName.default }}</span>
            {% if away_record %}
            <span class="preview-record">{{ away_record.w }}-{{ away_record.l }}-{{ away_record.otl }}</span>
            {% endif %}
        </div>

        <div class="preview-vs">
            <span class="vs-text">VS</span>
            <span class="preview-label">Game Preview</span>
        </div>

        <div class="preview-team">
            <img src="https://assets.nhle.com/logos/nhl/svg/{{ home.abbrev }}_dark.svg" class="preview-logo">
            <span class="preview-name">{{ home.placeName.default }}</span>
            {% if home_record %}
            <span class="preview-record">{{ home_record.w }}-{{ home_record.l }}-{{ home_record.otl }}</span>
            {% endif %}
        </div>
    </div>
</div>

<!-- Win Probability -->
<div class="card">
    <div class="section-header"><h2>üéØ Prediction</h2></div>

    <div class="win-prob-bar">
        <div class="prob-away" style="width: {{ 100 - home_win_prob }}%">
            <span>{{ away.abbrev }} {{ 100 - home_win_prob }}%</span>
        </div>
        <div class="prob-home" style="width: {{ home_win_prob }}%">
            <span>{{ home.abbrev }} {{ home_win_prob }}%</span>
        </div>
    </div>

    <div class="prediction-note">
        {% if home_win_prob > 55 %}
        <span class="edge-pick">üè† {{ home.abbrev }} is the favorite (home advantage + better form)</span>
        {% elif home_win_prob < 45 %}
        <span class="edge-pick">‚úàÔ∏è {{ away.abbrev }} is the favorite despite playing away</span>
        {% else %}
        <span class="edge-pick">‚öñÔ∏è Balanced game expected</span>
        {% endif %}
    </div>
</div>

<!-- AI Preview Points -->
<div class="card">
    <div class="section-header"><h2>ü§ñ AI Analysis</h2></div>

    <div class="preview-points">
        {% for point in preview_points %}
        <div class="preview-point">
            {{ point }}
        </div>
        {% else %}
        <div class="preview-point">
            üìä No detailed statistics available.
        </div>
        {% endfor %}
    </div>
</div>

<!-- Head to Head -->
{% if away_record and home_record %}
<div class="card">
    <div class="section-header"><h2>üìà Statistics Comparison</h2></div>

    <div class="stat-compare">
        <div class="compare-row">
            <span class="compare-val left">{{ away_record.gf }}</span>
            <span class="compare-label">Goals (GF)</span>
            <span class="compare-val right">{{ home_record.gf }}</span>
        </div>
        <div class="compare-row">
            <span class="compare-val left">{{ away_record.ga }}</span>
            <span class="compare-label">Goals Against (GA)</span>
            <span class="compare-val right">{{ home_record.ga }}</span>
        </div>
        <div class="compare-row">
            <span class="compare-val left {{ 'positive' if away_record.diff > 0 else 'negative' if away_record.diff < 0 }}">{{ '%+d'|format(away_record.diff) }}</span>
            <span class="compare-label">Differential</span>
            <span class="compare-val right {{ 'positive' if home_record.diff > 0 else 'negative' if home_record.diff < 0 }}">{{ '%+d'|format(home_record.diff) }}</span>
        </div>
        <div class="compare-row">
            <span class="compare-val left">{{ away_record.l10 }}</span>
            <span class="compare-label">Last 10</span>
            <span class="compare-val right">{{ home_record.l10 }}</span>
        </div>
    </div>
</div>
{% endif %}

<div class="preview-actions">
    <a href="{{ url_for('predict', game_id=game_id) }}" class="btn btn-primary">üéØ Predict Now</a>
    <a href="{{ url_for('live_game', game_id=game_id) }}" class="btn btn-secondary">üì∫ Watch Live</a>
</div>
{% endblock %}
